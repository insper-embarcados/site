<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
      
        <title>pyautogui - Computação Embarcada - 2.0</title>
      
    
    <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Fira+Sans+Extra+Condensed:700|Oxygen+Mono|Source+Sans+Pro:700|Source+Serif+Pro&amp;display=swap">
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script>
      // SETUP GLOBAL CONSTANTS
      var base_url = '../..';
      
      var telemetryEnabled = false;
      var backendUrl = "";
      var courseSlug = "";
      
      
      var dashboardEnabled = true;
      var tagTree = [{'reference': ['choice-exercise', 'parsons-exercise', 'text-exercise']}, {'grandparent-tag': [{'parent-tag': ['child-tag']}]}];
      

      // SETUP PLUGIN
      window.initialized = false;
      if (!window.initializers) window.initializers = [];
      window.registerInitializer = (initialize) => {
        if (window.initialized) initialize();
        else window.initializers.push(initialize);
      };
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="https://unpkg.com/hyperscript.org"></script>
    <script src="https://unpkg.com/htmx.org@1.8.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="../../assets/js/main.js"></script>
    
    <link rel="stylesheet" href="../../termynal.css">
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  <body>
    <div class="ah-main-container">
      <header class="ah-header">
        <button class="ah-menu-btn ah-button ah-button--borderless"
                aria-label="toggle menu">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
  <!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
  <path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/>
</svg>
        </button>
        <a href="../.."
           title="Computação Embarcada - 2.0"
           class="ah-logo"
           aria-label="Computação Embarcada - 2.0">
          Computação Embarcada - 2.0
        </a>
        <div class="ah-header--right">
          
          
          
          <button id="resetHandoutButton">
            <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
  <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
</svg></span>
          </button>
          

          
        </div>
      </header>
      <nav class="ah-navigation preload">
        <div class="ah-nav-container">
          <button class="ah-menu-btn ah-button ah-button--borderless close-menu"
                  aria-label="close menu">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
  <!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
  <path d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/>
</svg>
          </button>
          <ul class="ah-nav-body">
            
              
  
    <li>
      <a href="../..">Home</a>
    </li>
  

            
              
  
    <li>
      <a href="../../aulas/">Aulas</a>
    </li>
  

            
              
  
    <li>
      <a href="../../avaliacao/">Avaliação</a>
    </li>
  

            
              
  
    <li>
      <a href="../../infra-linux-docker/">Infra</a>
    </li>
  

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Prototipando</span>
    <ul>
      
        
  
    <li>
      <a href="../../prototipos/prototipos/">Fabricação</a>
    </li>
  

      
        
  
    <li>
      <a href="../../prototipos/entradas/">Entradas</a>
    </li>
  

      
        
  
    <li>
      <a href="../../prototipos/saida.md">Saídas</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item opened">
    <span class="ah-togglable-handle">Utils</span>
    <ul>
      
        
  
    <li>
      <a href="../utils-uinput/">Uinput</a>
    </li>
  

      
        
  

    <li class="active ah-togglable-item opened">
      <span class="ah-togglable-handle">pyautogui</span>
      <ul>
        
          
            
            
              <li class="ah-toc-item">
                <a href="#manter-tecla-pressionada">Manter tecla pressionada</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#keyboard">keyboard</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#emulando-mouse">Emulando mouse</a>
              </li>
            
              <li class="ah-toc-item">
                <a href="#code">Code</a>
              </li>
            
        
      </ul>
    </li>
  

      
        
  
    <li>
      <a href="../utils-vjoy/">vjoy</a>
    </li>
  

      
        
  
    <li>
      <a href="../utils-volume/">Volume</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Dispositivos</span>
    <ul>
      
        
  
    <li>
      <a href="../../dispositivos/buzzer.md">None</a>
    </li>
  

      
        
  
    <li>
      <a href="https://perrobotica.fandom.com/pt-br/wiki/Sensor_de_dist%C3%A2ncia_Hcsr04">HC-SR04</a>
    </li>
  

      
        
  
    <li>
      <a href="../../dispositivos/oled1/">OLED1</a>
    </li>
  

      
        
  
    <li>
      <a href="../../dispositivos/servo/">Servomotor</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Pico W</span>
    <ul>
      
        
  
    <li>
      <a href="https://datasheets.raspberrypi.com/picow/pico-w-datasheet.pdf">Datasheet</a>
    </li>
  

      
        
  
    <li>
      <a href="https://www.raspberrypi.com/documentation/microcontrollers/images/picow-pinout.svg">Hardware</a>
    </li>
  

      
        
  
    <li>
      <a href="../../pico/pico-examples/">pico-examples</a>
    </li>
  

      
        
  
    <li>
      <a href="../../pico/pico-debugging/">Programando</a>
    </li>
  

      
        
  
    <li>
      <a href="../../pico/pico-wifi/">WIFI</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">RP2040</span>
    <ul>
      
        
  
    <li>
      <a href="https://datasheets.raspberrypi.com/rp2040/rp2040-datasheet.pdf">Datasheet</a>
    </li>
  

      
        
  
    <li>
      <a href="https://www.raspberrypi.com/documentation/pico-sdk/index_doxygen.html">SDK</a>
    </li>
  

      
        
  
    <li>
      <a href="../../rp2040/rp2040-delay/">Delay</a>
    </li>
  

      
        
  
    <li>
      <a href="../../rp2040/rp2040-gpio/">GPIO</a>
    </li>
  

      
        
  
    <li>
      <a href="../../rp2040/rp2040-gpio-irq/">GPIO IRQ</a>
    </li>
  

      
        
  
    <li>
      <a href="../../rp2040/rp2040-timer/">Timer</a>
    </li>
  

      
        
  
    <li>
      <a href="../../rp2040/rp2040-rtc/">RTC</a>
    </li>
  

      
        
  
    <li>
      <a href="https://kevinboone.me/picoflash.html">Flash</a>
    </li>
  

      
        
  
    <li>
      <a href="../../rp2040/rp2040-adc/">ADC</a>
    </li>
  

      
        
  
    <li>
      <a href="../../rp2040/rp2040-pwm/">PWM</a>
    </li>
  

      
        
  
    <li>
      <a href="../../rp2040/rp2040-i2c/">I2C</a>
    </li>
  

      
        
  
    <li>
      <a href="../../rp2040/rp2040-dma/">DMA</a>
    </li>
  

      
        
  
    <li>
      <a href="../../rp2040/rp2040-uart/">UART</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">FreeRTOS</span>
    <ul>
      
        
  
    <li>
      <a href="../../freertos/freertos-basic/">RTOS</a>
    </li>
  

      
        
  
    <li>
      <a href="../../freertos/freertos-tasks/">Tasks</a>
    </li>
  

      
        
  
    <li>
      <a href="../../freertos/freertos-vtaskDelay/">VtaskDelay</a>
    </li>
  

      
        
  
    <li>
      <a href="../../freertos/freertos-software-time/">Software Timer</a>
    </li>
  

      
        
  
    <li>
      <a href="../../freertos/freertos-semaphore/">Semaphore</a>
    </li>
  

      
        
  
    <li>
      <a href="../../freertos/freertos-queue/">Queue</a>
    </li>
  

      
        
  
    <li>
      <a href="../../freertos/freertos-queue-advanced/">Queue struct</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Code quality</span>
    <ul>
      
        
  
    <li>
      <a href="../../CodeQuality/topview/">Visão geral</a>
    </li>
  

      
        
  
    <li>
      <a href="../../CodeQuality/rules/">Regras</a>
    </li>
  

      
        
  
    <li>
      <a href="../../CodeQuality/cppcheck/">Cppcheck</a>
    </li>
  

      
        
  
    <li>
      <a href="../../CodeQuality/variables/">Variáveis</a>
    </li>
  

      
        
  
    <li>
      <a href="../../CodeQuality/isr-variables/">ISR - variáveis</a>
    </li>
  

      
        
  
    <li>
      <a href="../../CodeQuality/isr-handler/">ISR - handler</a>
    </li>
  

      
        
  
    <li>
      <a href="../../CodeQuality/head-file/">Head File</a>
    </li>
  

      
        
  
    <li>
      <a href="../../CodeQuality/rtos/">RTOS</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Labs core</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs/pre-lab/">Preparatórios</a>
    </li>
  

      
        
  
    <li>
      <a href="../../labs/pra-lab/">Prática</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">GPIO</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs/gpio-pre-lab/">Preparatório</a>
    </li>
  

      
        
  
    <li>
      <a href="../../labs/gpio-pra-lab/">Prática</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">IRQ</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs/irq-pre-lab/">Preparatório</a>
    </li>
  

      
        
  
    <li>
      <a href="../../labs/irq-pra-lab/">Prática</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Timer</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs/timer-pre-lab/">Preparatório</a>
    </li>
  

      
        
  
    <li>
      <a href="../../labs/timer-pra-lab/">Prática</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">RTOS</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs/rtos-pre-lab/">Preparatório</a>
    </li>
  

      
        
  
    <li>
      <a href="../../labs/rtos-pra-lab/">Prática</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">ADC/PWM</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs/adc-pwm-pre-lab/">Preparatório</a>
    </li>
  

      
        
  
    <li>
      <a href="../../labs/adc-pwm-pra-lab/">Prática</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">I2C</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs/i2c-pre-lab/">Preparatório</a>
    </li>
  

      
        
  
    <li>
      <a href="../../labs/i2c-pra-lab/">Prática</a>
    </li>
  

      
    </ul>
  </li>

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Labs experts</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs-expert/labs-expert-about/">Sobre</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Comunicação</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs-expert/labs-expert-com-wifi/">WIFI</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">DSP</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs-expert/labs-expert-dsp-audio/">Áudio</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Sensores/Atuadores</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs-expert/labs-expert-sensors-servomotor/">Servomotor</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Firmware</span>
    <ul>
      
        
  
    <li>
      <a href="../../labs-expert/labs-expert-firmware-driver/">Driver</a>
    </li>
  

      
    </ul>
  </li>

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">APS</span>
    <ul>
      
        
  
    <li>
      <a href="../../aps/aps-1-genius/">Aps 1 genius</a>
    </li>
  

      
        
  
    <li>
      <a href="../../aps/aps-2-controle/">Aps 2 controle</a>
    </li>
  

      
    </ul>
  </li>

            
          </ul>
        </div>
      </nav>
      <main class="ah-content ah-typeset">
        
          <div class="ah-title-box">
            <ul class="ah-breadcrumbs">
              
                
                  
                    <li>Utils</li>
                  
                
                <li></li>
            </ul>
            
            
          </div>
          
            <section class="progress-section show">
<h1 id="pyautogui">Pyautogui</h1>
<p>O pyautogui é uma biblioteca que permite emularmos um teclado ou mouse no Windows (até funciona para alguns Linux, mas precisa estar rodando o gerenciador de janelas no X11 e a maioria das ditros modernas utiliza Wayland, que não é compatível).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Se o pyautogui não funcionar no seu jogo, substitua o pyautogui por pydirectinput.</p>
<div>
<iframe height="500" src="https://www.youtube.com/embed/LFDGgFRqVIs?autoplay=0" type="text/html" width="100%"></iframe>
</div>
</div>
<p>Para mais informações consulte a documentacão oficial:</p>
<ul>
<li>pyautogui: <a href="https://pyautogui.readthedocs.io/en/latest/">https://pyautogui.readthedocs.io/en/latest/</a></li>
</ul>
<h3 id="manter-tecla-pressionada">Manter tecla pressionada</h3>
<p>Por padrão a lib não permite manter uma tecla pressionada (e ficar repetitivamente enviando o mesmo valor), para desativar basta remover o delay:</p>
<div class="language-py highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">baudrate</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>        <span class="n">pyautogui</span><span class="o">.</span><span class="n">PAUSE</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1">## remove delay</span>
</code></pre></div>
<p>Agora uma tecla "pressionada" ira ser enviada repetitivamente</p>
<h3 id="keyboard">keyboard</h3>
<ul>
<li><a href="https://pyautogui.readthedocs.io/en/latest/keyboard.html#">https://pyautogui.readthedocs.io/en/latest/keyboard.html#</a></li>
</ul>
<p>O pyautogui disponibiliza duas formas diferentes de apertarmos uma tecla: </p>
<ul>
<li><code>press</code> que é uma ação de apertar e soltar uma tecla</li>
<li><code>keyDown</code> e <code>keyUp</code> que são aćoes distintas de apertar e soltar</li>
</ul>
<div class="language-py highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">pyautogui</span><span class="o">.</span><span class="n">keyDown</span><span class="p">(</span><span class="s1">&#39;shift&#39;</span><span class="p">)</span>  <span class="c1"># hold down the shift key</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">pyautogui</span><span class="o">.</span><span class="n">press</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>     <span class="c1"># press the left arrow key</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">pyautogui</span><span class="o">.</span><span class="n">press</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>     <span class="c1"># press the left arrow key</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">pyautogui</span><span class="o">.</span><span class="n">press</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>     <span class="c1"># press the left arrow key</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">pyautogui</span><span class="o">.</span><span class="n">keyUp</span><span class="p">(</span><span class="s1">&#39;shift&#39;</span><span class="p">)</span>    <span class="c1"># release the shift key</span>
</code></pre></div>
<p>Para uma lista das teclas suportas acesse:</p>
<ul>
<li><a href="https://pyautogui.readthedocs.io/en/latest/keyboard.html#keyboard-keys">https://pyautogui.readthedocs.io/en/latest/keyboard.html#keyboard-keys</a></li>
</ul>
<p>Se precisar fazer um combo (hotkeys) de teclas como o: <code>ctrl</code> + <code>alt</code> + <code>f4</code>, use o <code>hotkeys</code>:</p>
<div class="language-py highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">pyautogui</span><span class="o">.</span><span class="n">hotkey</span><span class="p">(</span><span class="s1">&#39;ctrl&#39;</span><span class="p">,</span> <span class="s1">&#39;shift&#39;</span><span class="p">,</span> <span class="s1">&#39;f4&#39;</span><span class="p">)</span>
</code></pre></div>
<h3 id="emulando-mouse">Emulando mouse</h3>
<p>A documentacão oficial é muito boa:</p>
<ul>
<li><a href="https://pyautogui.readthedocs.io/en/latest/mouse.html">https://pyautogui.readthedocs.io/en/latest/mouse.html</a></li>
</ul>
<h2 id="code">Code</h2>
<p>Código em python a seguir emula um mouse usando o pyautogui (compatível com os Labs 5 e 6)</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Note que no Windows a porta serial chama COM e possui um número atrelada a ela. Para verificar o seu ID utilize o <code>device management</code>.</p>
</div>
<p>Notem que a única coisa que alterna é o nome da porta serial:</p>
<div class="language-py highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;COM3&#39;</span><span class="p">,</span> <span class="mi">115200</span><span class="p">)</span>
</code></pre></div>
<p>E a função <code>mouve_mouse</code></p>
<div class="language-py highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">def</span> <span class="nf">move_mouse</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>    <span class="c1"># X-axis</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>        <span class="n">pyautogui</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Y-axis</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>        <span class="n">pyautogui</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<p>Código completo:</p>
<div class="language-py highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">import</span> <span class="nn">serial</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">import</span> <span class="nn">pyautogui</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">&#39;COM3&#39;</span><span class="p">,</span> <span class="mi">115200</span><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="k">def</span> <span class="nf">parse_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="n">axis</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 0 for X, 1 for Y</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received data: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;axis: </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2">, value: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    <span class="k">return</span> <span class="n">axis</span><span class="p">,</span> <span class="n">value</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="k">def</span> <span class="nf">move_mouse</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>    <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>    <span class="c1"># X-axis</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>        <span class="n">pyautogui</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>    <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Y-axis</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>        <span class="n">pyautogui</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>    <span class="c1"># sync package</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Waiting for sync package...&#39;</span><span class="p">)</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">ser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>            <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\xff</span><span class="s1">&#39;</span><span class="p">:</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>                <span class="k">break</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received error: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>        <span class="c1"># Read 4 bytes from UART</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">ser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>        <span class="n">axis</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">parse_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>        <span class="n">move_mouse</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Program terminated by user&quot;</span><span class="p">)</span>
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>    <span class="n">ser</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>


</section>
          
        
      </main>
      <footer class="ah-footer ah-typeset">
        <div class="ah-footer-nav">
          
            <a href="../utils-uinput/"
               class="ah-prev"
               title="Uinput">
              <span class="nav-label">Previous</span>
              <span class="nav-title">Uinput</span>
            </a>
          
          
            <a href="../utils-vjoy/"
               class="ah-next"
               title="vjoy">
              <span class="nav-label">Next</span>
              <span class="nav-title">vjoy</span>
            </a>
          
        </div>
      </footer>
    </div>
    
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script src="../../termynal.js"></script>
    
  <script>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});</script></body>
</html>